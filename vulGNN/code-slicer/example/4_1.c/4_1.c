digraph "Code Property Graph" {
	1 [label="1	int jbig2_immediate_generic_region ( Jbig2Ctx * ctx , Jbig2Segment * segment , const byte * segment_data ) {" shape=box]
	1 -> 13 [color=blue]
	1 -> 14 [color=blue]
	1 -> 15 [color=blue]
	1 -> 16 [color=blue]
	1 -> 17 [color=blue]
	1 -> 18 [color=blue]
	1 -> 21 [color=blue]
	1 -> 22 [color=blue]
	1 -> 23 [color=blue]
	1 -> 31 [color=blue]
	1 -> 32 [color=blue]
	1 -> 33 [color=blue]
	1 -> 35 [color=blue]
	1 -> 38 [color=blue]
	1 -> 39 [color=blue]
	1 -> 41 [color=blue]
	1 -> 45 [color=blue]
	1 -> 47 [color=blue]
	1 -> 50 [color=blue]
	1 -> 52 [color=blue]
	1 -> 55 [color=blue]
	1 -> 57 [color=blue]
	1 -> 58 [color=blue]
	1 -> 59 [color=blue]
	1 -> 60 [color=blue]
	1 -> 61 [color=blue]
	1 -> 62 [color=blue]
	2 [label="2	Jbig2RegionSegmentInfo rsi ;" shape=box]
	2 -> 33 [color=blue]
	2 -> 31 [color=blue]
	2 -> 57 [color=blue]
	2 -> 15 [color=blue]
	3 [label="3	byte seg_flags ;" shape=box]
	4 [label="4	int8_t gbat [ 8 ] ;" shape=box]
	4 -> 30 [color=blue]
	4 -> 22 [color=blue]
	4 -> 23 [color=blue]
	5 [label="5	int offset ;" shape=box]
	6 [label="6	int gbat_bytes = 0 ;" shape=box]
	6 -> 25 [color=blue]
	6 -> 30 [color=blue]
	7 [label="7	Jbig2GenericRegionParams params ;" shape=box]
	7 -> 26 [color=blue]
	8 [label="8	int code = 0 ;" shape=box]
	9 [label="9	Jbig2Image * image = NULL ;" shape=box]
	9 -> 10 [color=blue]
	10 [label="10	Jbig2WordStream * ws = NULL ;" shape=box]
	10 -> 11 [color=blue]
	10 -> 60 [color=blue]
	11 [label="11	Jbig2ArithState * as = NULL ;" shape=box]
	11 -> 59 [color=blue]
	11 -> 12 [color=blue]
	12 [label="12	Jbig2ArithCx * GB_stats = NULL ;" shape=box]
	12 -> 32 [color=blue]
	12 -> 40 [color=blue]
	12 -> 46 [color=blue]
	12 -> 51 [color=blue]
	12 -> 61 [color=blue]
	13 [label="13	if ( segment -> data_length < 18 ) return jbig2_error ( ctx , JBIG2_SEVERITY_FATAL , segment -> number , \"Segment too short\" ) ;" shape=box]
	13 -> 13 [color=red]
	13 -> 14 [color=red]
	13 -> 15 [color=red]
	13 -> 16 [color=red]
	13 -> 17 [color=red]
	13 -> 18 [color=red]
	13 -> 19 [color=red]
	14 [label="14	jbig2_get_region_segment_info ( & rsi , segment_data ) ;" shape=box]
	15 [label="15	jbig2_error ( ctx , JBIG2_SEVERITY_INFO , segment -> number , \"generic region: %d x %d @ (%d, %d), flags = %02x\" , rsi . width , rsi . height , rsi . x , rsi . y , rsi . flags ) ;" shape=box]
	16 [label="16	seg_flags = segment_data [ 17 ] ;" shape=box]
	16 -> 17 [color=blue]
	16 -> 18 [color=blue]
	16 -> 19 [color=blue]
	16 -> 20 [color=blue]
	16 -> 26 [color=blue]
	16 -> 27 [color=blue]
	16 -> 28 [color=blue]
	17 [label="17	jbig2_error ( ctx , JBIG2_SEVERITY_INFO , segment -> number , \"segment flags = %02x\" , seg_flags ) ;" shape=box]
	18 [label="18	if ( ( seg_flags & 1 ) && ( seg_flags & 6 ) ) jbig2_error ( ctx , JBIG2_SEVERITY_WARNING , segment -> number , \"MMR is 1, but GBTEMPLATE is not 0\" ) ;" shape=box]
	18 -> 18 [color=red]
	19 [label="19	if ( ! ( seg_flags & 1 ) ) {" shape=box]
	19 -> 32 [color=red]
	19 -> 20 [color=red]
	19 -> 21 [color=red]
	19 -> 25 [color=red]
	19 -> 26 [color=red]
	19 -> 27 [color=red]
	19 -> 28 [color=red]
	19 -> 29 [color=red]
	19 -> 30 [color=red]
	19 -> 31 [color=red]
	20 [label="20	gbat_bytes = ( seg_flags & 6 ) ? 2 : 8 ;" shape=box]
	20 -> 25 [color=blue]
	20 -> 21 [color=blue]
	20 -> 22 [color=blue]
	20 -> 30 [color=blue]
	21 [label="21	if ( 18 + gbat_bytes > segment -> data_length ) return jbig2_error ( ctx , JBIG2_SEVERITY_FATAL , segment -> number , \"Segment too short\" ) ;" shape=box]
	21 -> 32 [color=red]
	21 -> 21 [color=red]
	21 -> 22 [color=red]
	21 -> 23 [color=red]
	21 -> 25 [color=red]
	21 -> 26 [color=red]
	21 -> 27 [color=red]
	21 -> 28 [color=red]
	21 -> 29 [color=red]
	21 -> 30 [color=red]
	21 -> 31 [color=red]
	22 [label="22	memcpy ( gbat , segment_data + 18 , gbat_bytes ) ;" shape=box]
	23 [label="23	jbig2_error ( ctx , JBIG2_SEVERITY_INFO , segment -> number , \"gbat: %d, %d\" , gbat [ 0 ] , gbat [ 1 ] ) ;" shape=box]
	25 [label="25	offset = 18 + gbat_bytes ;" shape=box]
	25 -> 35 [color=blue]
	25 -> 45 [color=blue]
	26 [label="26	params . MMR = seg_flags & 1 ;" shape=box]
	26 -> 34 [color=blue]
	26 -> 27 [color=blue]
	27 [label="27	params . GBTEMPLATE = ( seg_flags & 6 ) >> 1 ;" shape=box]
	27 -> 28 [color=blue]
	27 -> 38 [color=blue]
	28 [label="28	params . TPGDON = ( seg_flags & 8 ) >> 3 ;" shape=box]
	28 -> 29 [color=blue]
	29 [label="29	params . USESKIP = 0 ;" shape=box]
	29 -> 38 [color=blue]
	29 -> 34 [color=blue]
	29 -> 30 [color=blue]
	30 [label="30	memcpy ( params . gbat , gbat , gbat_bytes ) ;" shape=box]
	31 [label="31	image = jbig2_image_new ( ctx , rsi . width , rsi . height ) ;" shape=box]
	31 -> 32 [color=blue]
	31 -> 35 [color=blue]
	31 -> 55 [color=blue]
	31 -> 57 [color=blue]
	31 -> 62 [color=blue]
	32 [label="32	if ( image == NULL ) return jbig2_error ( ctx , JBIG2_SEVERITY_FATAL , segment -> number , \"unable to allocate generic image\" ) ;" shape=box]
	32 -> 32 [color=red]
	32 -> 33 [color=red]
	32 -> 34 [color=red]
	32 -> 59 [color=red]
	32 -> 60 [color=red]
	32 -> 61 [color=red]
	32 -> 62 [color=red]
	32 -> 63 [color=red]
	33 [label="33	jbig2_error ( ctx , JBIG2_SEVERITY_DEBUG , segment -> number , \"allocated %d x %d image buffer for region decode results\" , rsi . width , rsi . height ) ;" shape=box]
	34 [label="34	if ( params . MMR ) {" shape=box]
	34 -> 35 [color=red]
	34 -> 38 [color=red]
	34 -> 39 [color=red]
	34 -> 40 [color=red]
	34 -> 57 [color=red]
	35 [label="35	code = jbig2_decode_generic_mmr ( ctx , segment , & params , segment_data + offset , segment -> data_length - offset , image ) ;" shape=box]
	35 -> 57 [color=blue]
	35 -> 63 [color=blue]
	38 [label="38	int stats_size = jbig2_generic_stats_size ( ctx , params . GBTEMPLATE ) ;" shape=box]
	38 -> 44 [color=blue]
	38 -> 39 [color=blue]
	39 [label="39	GB_stats = jbig2_new ( ctx , Jbig2ArithCx , stats_size ) ;" shape=box]
	39 -> 40 [color=blue]
	39 -> 44 [color=blue]
	39 -> 61 [color=blue]
	39 -> 55 [color=blue]
	40 [label="40	if ( GB_stats == NULL ) {" shape=box]
	40 -> 41 [color=red]
	40 -> 42 [color=red]
	40 -> 44 [color=red]
	40 -> 45 [color=red]
	40 -> 46 [color=red]
	41 [label="41	code = jbig2_error ( ctx , JBIG2_SEVERITY_FATAL , segment -> number , \"unable to allocate GB_stats in jbig2_immediate_generic_region\" ) ;" shape=box]
	41 -> 63 [color=blue]
	42 [label="42	goto cleanup ;" shape=box]
	44 [label="44	memset ( GB_stats , 0 , stats_size ) ;" shape=box]
	45 [label="45	ws = jbig2_word_stream_buf_new ( ctx , segment_data + offset , segment -> data_length - offset ) ;" shape=box]
	45 -> 50 [color=blue]
	45 -> 60 [color=blue]
	45 -> 46 [color=blue]
	46 [label="46	if ( ws == NULL ) {" shape=box]
	46 -> 48 [color=red]
	46 -> 50 [color=red]
	46 -> 51 [color=red]
	46 -> 47 [color=red]
	47 [label="47	code = jbig2_error ( ctx , JBIG2_SEVERITY_FATAL , segment -> number , \"unable to allocate ws in jbig2_immediate_generic_region\" ) ;" shape=box]
	47 -> 63 [color=blue]
	48 [label="48	goto cleanup ;" shape=box]
	50 [label="50	as = jbig2_arith_new ( ctx , ws ) ;" shape=box]
	50 -> 59 [color=blue]
	50 -> 51 [color=blue]
	50 -> 55 [color=blue]
	51 [label="51	if ( as == NULL ) {" shape=box]
	51 -> 57 [color=red]
	51 -> 52 [color=red]
	51 -> 53 [color=red]
	51 -> 55 [color=red]
	52 [label="52	code = jbig2_error ( ctx , JBIG2_SEVERITY_FATAL , segment -> number , \"unable to allocate as in jbig2_immediate_generic_region\" ) ;" shape=box]
	52 -> 63 [color=blue]
	53 [label="53	goto cleanup ;" shape=box]
	55 [label="55	code = jbig2_decode_generic_region ( ctx , segment , & params , as , image , GB_stats ) ;" shape=box]
	55 -> 57 [color=blue]
	55 -> 63 [color=blue]
	57 [label="57	if ( code >= 0 ) jbig2_page_add_result ( ctx , & ctx -> pages [ ctx -> current_page ] , image , rsi . x , rsi . y , rsi . op ) ;" shape=box]
	57 -> 57 [color=red]
	57 -> 58 [color=red]
	58 [label="58	else jbig2_error ( ctx , JBIG2_SEVERITY_FATAL , segment -> number , \"error while decoding immediate_generic_region\" ) ;" shape=box]
	59 [label="59	cleanup : jbig2_free ( ctx -> allocator , as ) ;" shape=box]
	60 [label="60	jbig2_word_stream_buf_free ( ctx , ws ) ;" shape=box]
	61 [label="61	jbig2_free ( ctx -> allocator , GB_stats ) ;" shape=box]
	62 [label="62	jbig2_image_release ( ctx , image ) ;" shape=box]
	63 [label="63	return code ;" shape=box]
}
